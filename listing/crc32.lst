     1                                  ;================================================
     2                                  
     3                                  section .text
     4                                  
     5                                  ;================================================
     6                                  
     7                                  global my_hash
     8                                  
     9                                  ;================================================
    10                                  
    11                                  ; rax, rcx, rdx, rsi, rdi, r8, r9, r10, r11
    12                                  
    13                                  ; entry: rdi = data
    14                                  ;        rsi = size
    15                                  
    16                                  my_hash:
    17                                  
    18 00000000 B8FFFFFFFF                      mov rax, 0FFFFFFFFh             ; start value of crc
    19 00000005 4831C9                          xor rcx, rcx                    ; counter for data
    20                                  
    21                                      .loop:
    22 00000008 83FE00                          cmp esi, 0                      ; while size != 0
    23 0000000B 7425                            je .ret
    24 0000000D FFCE                            dec esi 
    25                                  
    26 0000000F 4989C1                          mov r9, rax                     ; 
    27 00000012 49C1E908                        shr r9, 8                       ; crc >> 8
    28                                  
    29 00000016 480FB6D0                        movzx rdx, al                   ; lower byte crc
    30                                          ;and rdx, byte [crc32_look_up + 4 * rcx]
    31                                                                          ; rdx = rdx ^ *(data)
    32 0000001A 480FB6040F                      movzx rax, byte [rdi + rcx]
    33 0000001F 48FFC1                          inc rcx                         ; data++
    34                                  
    35 00000022 4831D0                          xor rax, rdx
    36 00000025 488B0485[00000000]              mov rax, [crc32_look_up + 4 * rax]
    37                                                                          ; value form crc look up table        
    38                                          
    39 0000002D 4C31C8                          xor rax, r9
    40 00000030 EBD6                            jmp .loop
    41                                  
    42                                      .ret:
    43 00000032 48F7D0                          not rax 
    44 00000035 C3                              ret 
    45                                  
    46                                  
    47                                  ;================================================
    48                                  
    49                                  section .data 
    50                                  
   114 00000000 00000000963007772C-     crc32_look_up: dd 0, 0x77073096, 0xEE0E612C, 0x990951BA,          0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3,          0x0EDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988,          0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91,          0x1DB71064, 0x6AB0
   114 00000009 610EEEBA51099919C4-
   114 00000012 6D078FF46A7035A563-
   114 0000001B E9A395649E3288DB0E-
   114 00000024 A4B8DC791EE9D5E088-
   114 0000002D D9D2972B4CB609BD7C-
   114 00000036 B17E072DB8E7911DBF-
   114 0000003F 906410B71DF220B06A-
   114 00000048 4871B9F3DE41BE847D-
   114 00000051 D4DA1AEBE4DD6D51B5-
   114 0000005A D4F4C785D38356986C-
   114 00000063 13C0A86B647AF962FD-
   114 0000006C ECC9658A4F5C0114D9-
   114 00000075 6C0663633D0FFAF50D-
   114 0000007E 088DC8206E3B5E1069-
   114 00000087 4CE44160D5727167A2-
   114 00000090 D1E4033C47D4044BFD-
   114 00000099 850DD26BB50AA5FAA8-
   114 000000A2 B5356C98B242D6C9BB-
   114 000000AB DB40F9BCACE36CD832-
   114 000000B4 755CDF45CF0DD6DC59-
   114 000000BD 3DD1ABAC30D9263A00-
   114 000000C6 DE518051D7C81661D0-
   114 000000CF BFB5F4B42123C4B356-
   114 000000D8 9995BACF0FA5BDB89E-
   114 000000E1 B802280888055FB2D9-
   114 000000EA 0CC624E90BB1877C6F-
   114 000000F3 2F114C6858AB1D61C1-
   114 000000FC 3D2D66B69041DC7606-
   114 00000105 71DB01BC20D2982A10-
   114 0000010E D5EF8985B1711FB5B6-
   114 00000117 06A5E4BF9F33D4B8E8-
   114 00000120 A2C9077834F9000F8E-
   114 00000129 A8099618980EE1BB0D-
   114 00000132 6A7F2D3D6D08976C64-
   114 0000013B 91015C63E6F4516B6B-
   114 00000144 62616C1CD83065854E-
   114 0000014D 0062F2ED95066C7BA5-
   114 00000156 011BC1F4088257C40F-
   114 0000015F F5C6D9B06550E9B712-
   114 00000168 EAB8BE8B7C88B9FCDF-
   114 00000171 1DDD62492DDA15F37C-
   114 0000017A D38C654CD4FB5861B2-
   114 00000183 4DCE51B53A7400BCA3-
   114 0000018C E230BBD441A5DF4AD7-
   114 00000195 95D83D6DC4D1A4FBF4-
   114 0000019E D6D36AE96943FCD96E-
   114 000001A7 34468867ADD0B860DA-
   114 000001B0 732D0444E51D03335F-
   114 000001B9 4C0AAAC97C0DDD3C71-
   114 000001C2 0550AA41022710100B-
   114 000001CB BE86200CC925B56857-
   114 000001D4 B3856F2009D466B99F-
   114 000001DD E461CE0EF9DE5E98C9-
   114 000001E6 D9292298D0B0B4A8D7-
   114 000001EF C7173DB359810DB42E-
   114 000001F8 3B5CBDB7AD6CBAC020-
   114 00000201 83B8EDB6B3BF9A0CE2-
   114 0000020A B6039AD2B1743947D5-
   114 00000213 EAAF77D29D1526DB04-
   114 0000021C 8316DC73120B63E384-
   114 00000225 3B64943E6A6D0DA85A-
   114 0000022E 6A7A0BCF0EE49DFF09-
   114 00000237 9327AE000AB19E077D-
   114 00000240 44930FF0D2A3088768-
   114 00000249 F2011EFEC206695D57-
   114 00000252 62F7CB67658071366C-
   114 0000025B 19E7066B6E761BD4FE-
   114 00000264 E02BD3895A7ADA10CC-
   114 0000026D 4ADD676FDFB9F9F9EF-
   114 00000276 BE8E43BEB717D58EB0-
   114 0000027F 60E8A3D6D67E93D1A1-
   114 00000288 C4C2D83852F2DF4FF1-
   114 00000291 67BBD16757BCA6DD06-
   114 0000029A B53F4B36B248DA2B0D-
   114 000002A3 D84C1B0AAFF64A0336-
   114 000002AC 607A0441C3EF60DF55-
   114 000002B5 DF67A8EF8E6E3179BE-
   114 000002BE 69468CB361CB1A8366-
   114 000002C7 BCA0D26F2536E26852-
   114 000002D0 95770CCC03470BBBB9-
   114 000002D9 1602222F260555BE3B-
   114 000002E2 BAC5280BBDB2925AB4-
   114 000002EB 2B046AB35CA7FFD7C2-
   114 000002F4 31CFD0B58B9ED92C1D-
   114 000002FD AEDE5BB0C2649B26F2-
   114 00000306 63EC9CA36A750A936D-
   114 0000030F 02A906099C3F360EEB-
   114 00000318 856707721357000582-
   114 00000321 4ABF95147AB8E2AE2B-
   114 0000032A B17B381BB60C9B8ED2-
   114 00000333 920DBED5E5B7EFDC7C-
   114 0000033C 21DFDB0BD4D2D38642-
   114 00000345 E2D4F1F8B3DD686E83-
   114 0000034E DA1FCD16BE815B26B9-
   114 00000357 F6E177B06F7747B718-
   114 00000360 E65A0888706A0FFFCA-
   114 00000369 3B06665C0B0111FF9E-
   114 00000372 658F69AE62F8D3FF6B-
   114 0000037B 6145CF6C1678E20AA0-
   114 00000384 EED20DD75483044EC2-
   114 0000038D B30339612667A7F716-
   114 00000396 60D04D476949DB776E-
   114 0000039F 3E4A6AD1AEDC5AD6D9-
   114 000003A8 660BDF40F03BD83753-
   114 000003B1 AEBCA9C59EBBDE7FCF-
   114 000003BA B247E9FFB5301CF2BD-
   114 000003C3 BD8AC2BACA3093B353-
   114 000003CC A6A3B4240536D0BA93-
   114 000003D5 06D7CD2957DE54BF67-
   114 000003DE D9232E7A66B3B84A61-
   114 000003E7 C4021B685D942B6F2A-
   114 000003F0 37BE0BB4A18E0CC31B-
   114 000003F9 DF055A8DEF022D     
   115                                   
   116                                  ;================================================ 
